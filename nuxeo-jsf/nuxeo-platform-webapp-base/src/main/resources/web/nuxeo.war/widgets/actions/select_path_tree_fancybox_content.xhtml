<c:if test="true"
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:c="http://java.sun.com/jstl/core"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:rich="http://richfaces.org/rich"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:a4j="http://richfaces.org/a4j"
  xmlns:nxd="http://nuxeo.org/nxweb/document"
  id="#{widget.id}_tree">

<c:if test="false">
Content included by the 'selectPathTreeFancybox' action displayed by the 'select_path_tree_fancybox' widget.
@since 10.3.

Parameters:
  - ecmPathWidgetId: the id of the 'ecm_path' surrounding widget
  - showAllDomains: the 'showAllDomains' property of the 'ecm_path' surrounding widget
</c:if>

<div>
  <h3>
    <h:outputText value="#{messages['label.search.popup.title']}"/>
  </h3>
  <div class="content">
    <rich:tree preserveModel="none"
      ajaxChildActivationEncodeBehavior="none"
      ajaxNodeSelectionEncodeBehavior="none"
      id="#{ecmPathWidgetId}_treeId"
      adviseNodeOpened="#{reducedTreeActions.adviseNodeOpened}"
      changeExpandListener="#{reducedTreeActions.changeExpandListener}"
      iconLeaf="#{nxd:iconPath(node.document)}"
      iconExpanded="#{nxd:iconPath(node.document)}"
      iconCollapsed="#{nxd:iconPath(node.document)}"
      rowKeyVar="rowKey"
      styleClass="labelTool"
      stateVar="nodeState"
      var="node">
      <rich:treeModelRecursiveAdaptor
        id="#{ecmPathWidgetId}_recursiveTreeNodesAdaptorId"
        roots="#{showAllDomains ? reducedTreeActions.rootNode : reducedTreeActions.treeRoots}"
        nodes="#{node.children}"
        leaf="#{node.children == null or node.children.size == 0}"
        styleClass="labelTool">
        <rich:treeNode
          id="#{ecmPathWidgetId}_treeNodeId"
          highlightedClass="treeNodeHighlightedClass"
          selectedClass="treeNodeSelectedClass">
          <a4j:commandLink immediate="true"
            id="#{ecmPathWidgetId}_linkId"
            actionListener="#{treeWidgetActions.addSelectionToList}"
            styleClass="treeLink" render="#{ecmPathWidgetId}_listRegion">
            <f:param name="selectionListId" value="#{ecmPathWidgetId}_list" />
            <f:param name="selectedPath" value="#{node.path}" />
            <h:outputText value="#{nxd:titleOrId(node.document)}" />
            <f:ajax event="click" execute="@this" render="#{ecmPathWidgetId}_listRegion" />
          </a4j:commandLink>
        </rich:treeNode>
      </rich:treeModelRecursiveAdaptor>
    </rich:tree>
  </div>
</div>
</c:if>